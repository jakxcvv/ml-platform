
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è - ML Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Arial, sans-serif; }
        body { background: #f5f7fa; color: #333; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        
        header { 
            background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        h1 { font-size: 32px; margin-bottom: 10px; }
        .subtitle { opacity: 0.9; font-size: 16px; }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        h2 { 
            color: #2c3e50; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th { background: #f8f9fa; font-weight: 600; color: #555; }
        
        .metric-badge {
            display: inline-block;
            background: #e9ecef;
            padding: 3px 8px;
            border-radius: 10px;
            margin: 2px;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h1>
            <p class="subtitle">–ê–Ω–∞–ª–∏–∑ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</p>
            <div>
                <a href="/" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ –¥–∞—à–±–æ—Ä–¥—É</a>
                <button onclick="refreshCharts()" class="btn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏</button>
            </div>
        </header>
        
        <div class="charts-grid">
            <div class="chart-card">
                <h2>üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ (Accuracy)</h2>
                <div class="chart-container">
                    <canvas id="accuracyChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üéØ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ F1-Score</h2>
                <div class="chart-container">
                    <canvas id="f1Chart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üìâ –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (Confusion Matrix)</h2>
                <div class="chart-container">
                    <canvas id="confusionMatrix"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</h2>
                <div class="chart-container">
                    <canvas id="metricsDistribution"></canvas>
                </div>
            </div>
        </div>
        
        <div class="chart-card" style="margin-top: 25px;">
            <h2>üìã –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</h2>
            <table>
                <thead>
                    <tr>
                        <th>–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç</th>
                        <th>–ê–ª–≥–æ—Ä–∏—Ç–º</th>
                        <th>Accuracy</th>
                        <th>Precision</th>
                        <th>Recall</th>
                        <th>F1-Score</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exp in experiments %}
                    <tr>
                        <td><a href="/experiment/{{ exp.id }}">{{ exp.name }}</a></td>
                        <td>{{ exp.algorithm }}</td>
                        <td>{{ exp.metrics.get('accuracy', 'N/A') }}</td>
                        <td>{{ exp.metrics.get('precision', 'N/A') }}</td>
                        <td>{{ exp.metrics.get('recall', 'N/A') }}</td>
                        <td>{{ exp.metrics.get('f1_score', 'N/A') }}</td>
                        <td>{{ exp.status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        const chartData = {{ chart_data|safe }};
        
        // –ì—Ä–∞—Ñ–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏
        const accuracyCtx = document.getElementById('accuracyChart').getContext('2d');
        const accuracyChart = new Chart(accuracyCtx, {
            type: 'bar',
            data: {
                labels: chartData.experiment_names,
                datasets: [{
                    label: 'Accuracy',
                    data: chartData.accuracy_scores,
                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1.0,
                        ticks: {
                            callback: function(value) {
                                return (value * 100).toFixed(0) + '%';
                            }
                        }
                    }
                }
            }
        });
        
        // –ì—Ä–∞—Ñ–∏–∫ F1-Score
        const f1Ctx = document.getElementById('f1Chart').getContext('2d');
        const f1Chart = new Chart(f1Ctx, {
            type: 'line',
            data: {
                labels: chartData.experiment_names,
                datasets: [{
                    label: 'F1-Score',
                    data: chartData.f1_scores,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderWidth: 3,
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1.0,
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(2);
                            }
                        }
                    }
                }
            }
        });
        
        // –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
        const matrixCtx = document.getElementById('confusionMatrix').getContext('2d');
        const confusionMatrix = new Chart(matrixCtx, {
            type: 'matrix',
            data: {
                datasets: [{
                    label: 'Confusion Matrix',
                    data: [
                        {x: 'True Positive', y: 'Predicted Positive', v: 85},
                        {x: 'False Negative', y: 'Predicted Positive', v: 15},
                        {x: 'False Positive', y: 'Predicted Negative', v: 10},
                        {x: 'True Negative', y: 'Predicted Negative', v: 90}
                    ],
                    backgroundColor: function(context) {
                        const value = context.dataset.data[context.dataIndex].v;
                        const alpha = value / 100;
                        return `rgba(255, 99, 132, ${alpha})`;
                    },
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                    width: 100,
                    height: 100
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.raw.x}, ${context.raw.y}: ${context.raw.v}`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        type: 'category',
                        labels: ['Predicted Positive', 'Predicted Negative'],
                        offset: true,
                        grid: {
                            display: false
                        }
                    },
                    y: {
                        type: 'category',
                        labels: ['True Positive', 'False Negative', 'False Positive', 'True Negative'],
                        offset: true,
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
        
        // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
        const distCtx = document.getElementById('metricsDistribution').getContext('2d');
        const metricsDistribution = new Chart(distCtx, {
            type: 'radar',
            data: {
                labels: ['Accuracy', 'Precision', 'Recall', 'F1-Score', 'Speed', 'Memory'],
                datasets: [
                    {
                        label: '–õ—É—á—à–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç',
                        data: [0.95, 0.92, 0.93, 0.94, 0.85, 0.78],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                    },
                    {
                        label: '–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è',
                        data: [0.85, 0.82, 0.83, 0.84, 0.75, 0.65],
                        borderColor: 'rgba(54, 162, 235, 1)',
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        pointBackgroundColor: 'rgba(54, 162, 235, 1)'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 1.0
                    }
                }
            }
        });
        
        function refreshCharts() {
            accuracyChart.update();
            f1Chart.update();
            confusionMatrix.update();
            metricsDistribution.update();
        }
    </script>
</body>
</html>
